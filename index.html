<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FCFS CPU Scheduling Calculator</title>

<!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: #eef1f5;
  }

  header {
    background: #1f2937;
    color: white;
    padding: 20px;
    text-align: center;
  }

  .app-card {
    background: white;
    padding: 20px;
    margin-top: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  }

  /* table inputs fill the cell */
  .table input {
    width: 100%;
    box-sizing: border-box;
  }

  /* delete button style preserved */
  .delete-btn {
    background: #dc2626;
    color: white;
    padding: 6px 10px;
    border: none;
    border-radius: 5px;
  }

  /* Gantt chart: allow wrapping on small screens */
  .gantt-container {
    display: flex;
    gap: 10px;
    padding: 8px 0;
    flex-wrap: wrap;           /* allow wrapping so it fits on small screens */
    align-items: flex-end;
  }

  .gantt-block {
    padding: 8px 10px;
    background: #d1d5db;
    border-radius: 6px;
    border: 1px solid #555;
    min-width: 56px;           /* small min width for phones */
    text-align: center;
    white-space: nowrap;
    font-size: 13px;
  }

  .footer-time {
    font-size: 12px;
    text-align: center;
    margin-top: 4px;
  }

  /* Make action buttons full-width on xs devices */
  @media (max-width: 575.98px) {
    .btn-action {
      width: 100%;
      margin-bottom: 8px;
    }
  }
</style>
</head>
<body>

<header>
  <h1 class="mb-0">FCFS CPU Scheduling Calculator</h1>
  <p class="mb-0">Educational tool for First-Come, First-Serve scheduling (mobile-friendly)</p>
</header>

<div class="container app-card">

  <!-- Processes section -->
  <h4 class="mb-3">Enter Processes</h4>

  <!-- responsive table wrapper -->
  <div class="table-responsive">
    <table class="table table-bordered align-middle" id="processTable">
      <thead class="table-dark">
        <tr>
          <th style="width: 35%;">Process Name</th>
          <th style="width: 20%;">Arrival Time</th>
          <th style="width: 20%;">Burst Time</th>
          <th style="width: 25%;">Action</th>
        </tr>
      </thead>
      <tbody id="processTableBody">
        <!-- rows added by JS -->
      </tbody>
    </table>
  </div>

  <!-- buttons: stacked on small -->
  <div class="d-flex flex-column flex-sm-row justify-content-center gap-2 my-3">
    <button class="btn btn-success btn-action" id="addBtn">Add Process</button>
    <button class="btn btn-primary btn-action" id="genBtn">Generate Results</button>
  </div>

  <!-- Results table -->
  <h4 class="mt-4 mb-2">FCFS Results</h4>
  <div class="table-responsive">
    <table class="table table-bordered table-hover">
      <thead class="table-dark">
        <tr>
          <th>Process</th>
          <th>Arrival Time</th>
          <th>Burst Time</th>
          <th>Start Time</th>
          <th>Completion</th>
          <th>Turnaround</th>
          <th>Waiting</th>
        </tr>
      </thead>
      <tbody id="resultTable"></tbody>
    </table>
  </div>

  <!-- Gantt -->
  <h4 class="mt-4 mb-2">Gantt Chart</h4>
  <div id="ganttChart" class="gantt-container"></div>

</div>

<script>
  // keep original logic, but improved DOM targets & safety
  let processCount = 0;

  const addBtn = document.getElementById('addBtn');
  const genBtn = document.getElementById('genBtn');
  const processTableBody = document.getElementById('processTableBody');
  const resultTable = document.getElementById('resultTable');
  const ganttChart = document.getElementById('ganttChart');

  addBtn.addEventListener('click', addProcess);
  genBtn.addEventListener('click', calculateFCFS);

  function addProcess() {
    processCount++;
    const defaultName = 'P' + processCount;

    const tr = document.createElement('tr');

    tr.innerHTML = `
      <td><input type="text" id="p${processCount}" value="${defaultName}" class="form-control form-control-sm" /></td>
      <td><input type="number" id="a${processCount}" min="0" class="form-control form-control-sm" /></td>
      <td><input type="number" id="b${processCount}" min="1" class="form-control form-control-sm" /></td>
      <td>
        <div class="d-flex gap-2 flex-wrap">
          <button type="button" class="delete-btn" title="Delete row">Delete</button>
        </div>
      </td>
    `;

    // attach delete handler
    tr.querySelector('.delete-btn').addEventListener('click', () => tr.remove());

    processTableBody.appendChild(tr);

    // focus the arrival time input for quicker entry on mobile
    const arrivalInput = tr.querySelector(`#a${processCount}`);
    if (arrivalInput) arrivalInput.focus();
  }

  function calculateFCFS() {
    const rows = Array.from(processTableBody.querySelectorAll('tr'));
    if (rows.length === 0) {
      alert('Please add at least one process.');
      return;
    }

    const processes = [];

    for (let i = 0; i < rows.length; i++) {
      const row = rows[i];
      const nameInput = row.querySelector('td:nth-child(1) input');
      const arrivalInput = row.querySelector('td:nth-child(2) input');
      const burstInput = row.querySelector('td:nth-child(3) input');

      const name = (nameInput?.value || '').trim();
      const arrival = arrivalInput?.value;
      const burst = burstInput?.value;

      if (arrival === '' || burst === '') {
        alert('Arrival Time and Burst Time must not be empty.');
        return;
      }

      const at = Number(arrival);
      const bt = Number(burst);

      if (!Number.isFinite(at) || !Number.isFinite(bt) || at < 0 || bt <= 0) {
        alert('Arrival must be â‰¥ 0 and Burst must be > 0.');
        return;
      }

      processes.push({
        name: name || `P${i+1}`,
        arrival: at,
        burst: bt
      });
    }

    // FCFS by arrival
    processes.sort((a,b) => a.arrival - b.arrival);

    // compute times
    let time = 0;
    const results = [];
    let ganttHTML = '';

    processes.forEach(p => {
      const start = Math.max(time, p.arrival);
      const completion = start + p.burst;
      const tat = completion - p.arrival;
      const wt = tat - p.burst;

      results.push({ ...p, start, completion, tat, wt });

      // Gantt block (name and times)
      ganttHTML += `
        <div class="gantt-block">
          <div>${p.name}</div>
          <div class="footer-time">${start} - ${completion}</div>
        </div>
      `;

      time = completion;
    });

    // render results table
    resultTable.innerHTML = '';
    results.forEach(r => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${r.name}</td>
        <td>${r.arrival}</td>
        <td>${r.burst}</td>
        <td>${r.start}</td>
        <td>${r.completion}</td>
        <td>${r.tat}</td>
        <td>${r.wt}</td>
      `;
      resultTable.appendChild(tr);
    });

    // render gantt
    ganttChart.innerHTML = ganttHTML;
  }

  // Optional: add a default sample row so users see the form immediately on mobile
  // Uncomment the next line if you'd like a default starter row:
  // addProcess();
</script>

<!-- Bootstrap bundle (optional for some Bootstrap JS features) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
